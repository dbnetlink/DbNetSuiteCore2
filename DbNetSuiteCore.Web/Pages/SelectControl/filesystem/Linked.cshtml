@page
@using DbNetSuiteCore.Enums
@using DbNetSuiteCore.Helpers
@using DbNetSuiteCore.Models
@using Microsoft.AspNetCore.Html

@{
    var selectModels = new List<SelectModel>();
    while (selectModels.Count() < 1)
    {
        var model = new SelectModel(DataSourceType.FileSystem, string.Empty) { Search = false };
        model.Columns = new List<SelectColumn>() { 
            new SelectColumn(FileSystemColumn.Name.ToString()),
            new SelectColumn(FileSystemColumn.Path.ToString()) {DataOnly = true}
        };
        model.ClientEvents[SelectClientEvent.OptionSelected] = "showSelectedFile";

        if (selectModels.Any())
        {
            selectModels.Last().LinkedControl = model;
        }

        selectModels.Add(model);
    }

    var rootFolder = new SelectModel(DataSourceType.FileSystem, "/data") { Search = false };
    rootFolder.Columns = new List<SelectColumn>()
    {
        new SelectColumn(FileSystemColumn.Name.ToString())
    };

    rootFolder.LinkedControl = selectModels.First();

    <div style="display:flex;flex-direction:row; gap:5px;align-items:center">

        @{
            <div>
                @(await DbNetSuiteCore.Control.Create(HttpContext).Render(rootFolder))
            </div>

            foreach (SelectModel subFolder in selectModels)
            {
                @RightChevron()
                <div>
                    @(await DbNetSuiteCore.Control.Create(HttpContext).Render(subFolder))
                </div>
            }
        }
            <div>
                <b>Selected file</b>
            </div>
            @RightChevron()
            <div id="selectedFile"></div>
    </div>
   
}
<script>
    function showSelectedFile(selectControl, args) {
        if (args.selectedOptions.length) {
            document.querySelector("#selectedFile").innerHTML = `${args.selectedOptions[0].text} ( ${args.selectedOptions[0].dataset.path} )`
        }
    }
</script>

@functions
{
        HtmlString RightChevron()
        {
        return new HtmlString("<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24\" width=\"24\" viewBox=\"0 0 640 640\"><!--!Font Awesome Free v7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path fill=\"#8790a2\" d=\"M471.1 297.4C483.6 309.9 483.6 330.2 471.1 342.7L279.1 534.7C266.6 547.2 246.3 547.2 233.8 534.7C221.3 522.2 221.3 501.9 233.8 489.4L403.2 320L233.9 150.6C221.4 138.1 221.4 117.8 233.9 105.3C246.4 92.8 266.7 92.8 279.2 105.3L471.2 297.3z\"/></svg>");
    }
}